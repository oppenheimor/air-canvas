# air-canvas
基于浏览器的手部追踪绘画应用 - 用双手在空中作画

## 项目概述

**Air Canvas** 是一个基于浏览器的手势绘画应用，使用 MediaPipe 实现手部追踪技术，让用户可以通过手势在空中进行绘画创作。项目采用现代化的 React + TypeScript + Vite 技术栈构建，集成了多种手势识别功能和智能绘图模式。

## 核心功能特性

### ✋ 手势识别系统
- **基础绘画手势**：食指伸直进行自由绘画
- **擦除手势**：握拳状态切换到擦除模式
- **菜单手势**：五指张开显示控制面板
- **矢量图形手势**：
  - 直线：食指+中指伸直
  - 圆形：OK 手势（拇指+食指相碰+中指伸直）
  - 矩形：拇指伸直+其他手指弯曲

### 🎨 绘画功能
- **自由绘画模式**：支持多种颜色和画笔大小
- **擦除模式**：可调节擦除器大小
- **矢量绘图模式**：智能图形识别和绘制
- **实时画布预览**：支持响应式布局
- **一键清空画布**

### 🖥️ 用户界面
- **现代化设计**：采用 Tailwind CSS + shadcn/ui 组件库
- **深色/浅色主题切换**：支持系统主题自动适配
- **响应式布局**：适配桌面端和移动端
- **实时摄像头预览**：翻转显示符合用户直觉
- **状态指示器**：显示当前手势类型和置信度

## 技术架构

### 前端技术栈
```json
{
  "核心框架": "React 19.1.0 + TypeScript",
  "构建工具": "Vite 7.0.4",
  "样式方案": "Tailwind CSS 4.1.11",
  "UI组件库": "Radix UI + shadcn/ui",
  "图标库": "Lucide React",
  "手势追踪": "MediaPipe Hands 0.4.x"
}
```

### 项目结构
```
src/
├── components/          # React 组件
│   ├── Canvas.tsx      # 主画布组件
│   ├── ControlPanel.tsx # 控制面板
│   ├── ThemeToggle.tsx # 主题切换器
│   └── ui/             # shadcn/ui 基础组件
├── hooks/
│   └── useHandTracking.ts # 手部追踪 Hook
├── utils/
│   └── gestureRecognition.ts # 手势识别算法
├── types/
│   └── mediapipe.d.ts  # MediaPipe 类型定义
└── lib/
    └── utils.ts        # 工具函数
```

### 核心算法实现

#### 手势识别算法
- **手指状态检测**：基于手部 21 个关键点计算手指伸展状态
- **手势分类器**：多种手势模式的优先级判断系统
- **手势稳定化**：5 帧历史记录防抖算法，提升识别稳定性
- **坐标映射**：翻转 X 轴坐标以匹配用户直觉操作

#### 智能图形识别
- **轨迹分析**：记录最多 50 个轨迹点进行形状分析
- **直线检测**：计算点到直线距离的平均偏差
- **圆形检测**：基于中心点和半径变化的稳定性分析
- **矩形检测**：边界框检测结合边缘点分布分析

## 开发历程

### 第一阶段：项目初始化 (Day 1)
1. **技术选型决策**
   - 选择 React + Vite 作为基础框架
   - 集成 MediaPipe 实现手部追踪
   - 采用 Tailwind CSS + shadcn/ui 构建现代化 UI

2. **核心架构搭建**
   - 创建 `useHandTracking` Hook 封装 MediaPipe 逻辑
   - 实现基础的 Canvas 绘画功能
   - 搭建组件化的控制面板

### 第二阶段：手势识别系统 (Day 1-2)
1. **基础手势实现**
   - 实现食指绘画、握拳擦除、五指菜单手势
   - 开发手势稳定化算法解决抖动问题
   - 优化坐标映射逻辑

2. **高级手势扩展**
   - 增加矢量图形手势（直线、圆形、矩形）
   - 开发智能图形识别系统
   - 实现轨迹分析和形状检测算法

### 第三阶段：用户体验优化 (Day 2)
1. **界面优化**
   - 实现深色/浅色主题切换
   - 优化响应式布局适配
   - 添加摄像头预览和状态指示

2. **交互体验提升**
   - 添加详细的使用说明指导
   - 优化加载状态和错误处理
   - 实现一键清空画布功能

### 第四阶段：稳定性和性能 (Day 2-3)
1. **错误处理机制**
   - 实现 MediaPipe 初始化超时保护
   - 添加多 CDN 源加载策略
   - 优化摄像头权限处理流程

2. **性能优化**
   - 实现帧数据处理优化
   - 添加手势历史记录管理
   - 优化画布重绘性能

## 技术亮点

### 🎯 核心创新点
1. **手势映射算法**：创新的手部关键点分析算法，支持 7 种不同手势识别
2. **智能图形识别**：基于轨迹分析的实时图形检测，支持直线、圆形、矩形自动识别
3. **手势稳定化系统**：多帧手势历史分析，有效解决手势抖动问题
4. **直觉化交互设计**：翻转 X 轴坐标映射，让手势操作符合用户自然直觉

### 🔧 技术实现细节
1. **MediaPipe 集成**：
   - 多 CDN 源策略确保资源加载稳定性
   - 初始化超时保护机制（30秒）
   - 摄像头权限处理和错误恢复

2. **Canvas 绘图优化**：
   - 支持矢量和位图混合绘制
   - 实时坐标转换和缩放适配
   - 高性能的重绘机制

3. **状态管理架构**：
   - React Hooks 最佳实践
   - 清晰的状态数据流
   - 组件间松耦合设计

## 部署配置

### 开发环境启动
```bash
# 安装依赖
pnpm install

# 启动开发服务器
pnpm run dev

# 构建生产版本
pnpm run build

# 预览构建结果
pnpm run preview
```

### 生产环境要求
- **浏览器兼容性**：需要支持 WebRTC 和 Canvas API
- **摄像头权限**：必须在 HTTPS 环境下运行
- **网络要求**：首次加载需要下载 MediaPipe 模型文件（约 10MB）

## 未来扩展方向

### 功能增强
- [ ] 多人协作绘画模式
- [ ] 绘画作品保存和分享
- [ ] 更多手势类型支持（双手操作）
- [ ] 3D 空间绘画模式
- [ ] 语音控制集成

### 技术优化
- [ ] WebGL 渲染优化
- [ ] 离线模式支持
- [ ] 移动端性能优化
- [ ] WebAssembly 算法加速

### 用户体验
- [ ] 个性化设置存储
- [ ] 教程和引导系统
- [ ] 无障碍访问支持
- [ ] 多语言国际化

## 开发团队

本项目由 Claude 协助开发，展现了 AI 辅助编程在复杂前端项目中的实际应用能力。

## 项目特色

Air Canvas 不仅是一个技术展示项目，更是探索未来人机交互方式的创新尝试。通过将手势识别技术与创意绘画相结合，为用户提供了一种全新的数字艺术创作体验。

项目的成功实现证明了现代 Web 技术在复杂实时应用中的强大能力，也为类似的手势交互项目提供了完整的技术参考方案。

## 技术总结

### 关键技术点
1. **MediaPipe 手部追踪**
   - 21 个手部关键点实时检测
   - 多手检测支持（最多 2 只手）
   - 高精度位置追踪（检测置信度 > 0.5）

2. **手势识别算法**
   - 基于几何关系的手指状态判断
   - 多种手势优先级分类系统
   - 时间序列稳定化算法

3. **Canvas 2D 绘图**
   - 实时路径绘制
   - 矢量图形渲染
   - 多图层管理

4. **React 状态管理**
   - 函数式组件 + Hooks 架构
   - 状态提升和数据流管理
   - 生命周期优化

### 性能优化策略
- 帧率控制（30fps）减少 CPU 占用
- 轨迹点数量限制（最多 50 个点）
- 手势历史缓存（5 帧）提升稳定性
- 异步初始化避免界面阻塞

### 错误处理机制
- MediaPipe 加载超时处理
- 摄像头权限拒绝恢复
- 网络异常重试机制
- 优雅降级策略

这个项目为后续开发者提供了一个完整的手势交互应用开发框架，可以作为类似项目的技术参考和起点。
